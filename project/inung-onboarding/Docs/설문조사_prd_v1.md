# 설문조사_prd_v1

## 배경
> 설문 조사는 산업, 복지, 교육 등 넒은 분야에서 사용되고 있습니다. 설문 조사 담당자에게는 분야에 따라 간편하게 설문 조사의 구성을 제공하고, 사용자에게는 접근이 용이하며 가독성 좋게 설문 조사를 제공해야 하는 수요가 증가하고 있습니다.
---
## 목표
> 담당자가 설문 조사 양식을 구성하고, 사용자는 구성된 양식을 통해 설문 조사에 대한 응답이 가능해야 합니다.
- 설문 조사 양식에 대한 생성이 가능해야 한다.
- 이미 구성된 설문 조사 양식에 대한 수정이 가능해야 한다.
- 구성된 설문 조사를 통해 조사에 대한 응답을 제출할 수 있어야 한다.
- 응답이 완료된 설문 조사에 대해서는 조회가 가능해야 한다.
---
## 요구 사항
### 기능적 요구 사항
**설문 조사 생성**
- 목적 : 새로운 설문 조사 양식을 구성할 수 있습니다.
- 입력 : 설문 조사 이름, 설명, 질문
- 출력 : 생성된 설문 조사 ID
- 제한 사항
	- 설문 조사 이름, 질문은 필수 입력 사항 입니다.
	- 질문은 이름, 설명, 입력 형태, 필수 여부로 구성되며, **최소 1개 이상 최대 10개 이하** 입니다.
	- 필수 여부가 `true`인 항목은 **필수로 응답 값이 입력** 되어야 합니다.
	- 질문의 입력 형태는 `단답형, 장문형, 단일 선택 리스트, 다중 선택 리스트`로 구성합니다.
	- `단일 선택 리스트`와 `다중 선택 리스트`의 경우 선택 할 수 있는 **옵션이 최소 1개 이상 입력** 되어야 합니다.

**설문 조사 수정**
- 목적 : 기존에 등록된 설문 조사 양식의 이름, 설명, 항목 구성을 수정할 수 있습니다.
- 입력 : 설문 조사 이름, 설명, 항목
- 출력 : 수정된 설문 조사 ID
- 제한 사항
	- 설문 조사 **식별자는 필수 입력 사항**입니다.
	- **이미 삭제된 설문 조사**라면 **수정이 불가능** 합니다.
	- **질문이 최소 1개 이상 최대 10개 이하**가 아니라면 수정이 불가능 합니다.
	- `단일 선택 리스트`와 `다중 선택 리스트`의 경우 선택 할 수 있는 **옵션이 최소 1개 이상** 입력 되어야 합니다.
    - 수정 요청한 질문은 **설문 조사의 버전을 다르게 반영**합니다.
	- 수정된 설문 조사의 **이전 응답은 유지**되어야 합니다.
    - 수정된 설문 조사의 **버전이 1 증가**합니다.

**설문 조사 응답 제출**
- 목적 : 설문 조사를 수행한 결과를 제출할 수 있습니다.
- 입력 : 질문 이름, 응답 값
- 출력 : 응답 ID
- 제한 사항
	- **질문의 수와 응답한 값의 수가 동일**해야 합니다.
    - 질문은 해당 설문 조사에 **등록된 질문과 일치**해야 합니다.
    - 질문의 형태가 설문 조사에 **등록된 질문의 형태와 일치**해야 합니다.
	- 단일 선택 리스트 및 다중 선택 리스트의 응답 값은 등록된 **질문의 옵션에 포함된 값**이어야 합니다.

**설문 조사 응답 조회**
- 목적 : 선택한 설문 조사의 응답 결과를 조회할 수 있습니다.
- 입력 : 설문 조사 식별자 및 질문과 응답 값
- 출력 : 해당 설문의 응답
- 제한 사항
	- 설문 조사 식별자 값은 필수 입력 사항입니다.
	- 질문과 응답 값을 기반으로 검색 할 수 있습니다.

### 비기능적 요구 사항 : 생략

### 📌 제약 사항 해결 전략
#### 설문 조사 수정 시 이전 응답 유지
**데이터 무결성 측면**
> 설문의 응답은 그 시점의 설문 구조를 기반으로 제출된 데이터이기 때문에 설문 항목이나 옵션이 변경될 경우 기존 응답의 의미가 달라질 수 있습니다. 이런 경우 데이터 무결성이 깨질 수 있기 때문에 버전 별로 응답의 의미를 구분하여 결과를 확인할 수 있도록 구성합니다.

예시
```text
ver 1: "만족도는?" → [만족, 보통, 불만족]
ver 2: "만족도는?" → [매우 만족, 만족, 보통, 불만족]
```

**문맥 보존 측면**
> 모든 응답은 그 시점의 질문과 옵션을 기반으로 해석해야 하기 때문에 동일한 응답 값이더라도 버전별 의미를 파악하여 해석할 수 있도록 구성되어야 합니다.

**정확한 통계 측면**
> 구글 폼을 예시로 봤을 때 설문에서 기존 질문을 삭제하고, 수정된 설문에 응답하면 현재는 존재하지 않는 답변이 통계에 포함됩니다. 이럴 경우 통계된 결과가 오염될 수 있기 때문에 정확한 통계를 위하여 현재 설문 버전에 해당하는 응답 결과만을 확인할 수 있도록 구성합니다.

위 세가지 항목을 충족하기 위하여 아래와 같은 조건이 충족되도록 구현합니다.
- 설문 조사 ID와 버전으로 응답을 구분합니다.
- 설문 조사 수정 시, 기존 응답은 그대로 유지하고 새로운 버전의 설문 조사를 생성합니다.
- 응답 제출 시, 설문 조사 ID와 버전을 함께 저장합니다.
- 응답 조회 시, 설문 조사 ID와 버전을 통해 응답을 필터링합니다.
- 별도의 JSON 파싱 등의 작업 없이 설문 조사 버전에 따른 응답 결과를 구분하여 조회할 수 있습니다.
